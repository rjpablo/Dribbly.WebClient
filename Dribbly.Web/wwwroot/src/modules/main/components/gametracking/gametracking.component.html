<div drbbly-overlay="gdg.gameDetailsOverlay">
    <div class="container px-0 min-height-300">
        <!-- Game Title -->
        <div class="row my-3">
            <div class="col-12">
                <div class="text-center">
                    <a ui-sref="main.game.details(gdg.game.id)"
                       class="d-inline-block text-white">
                        <h5 class="text-white">{{gdg.game.title}}</h5>
                    </a>
                </div>
            </div>
        </div>
        <!-- Score Board -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="score-board">
                    <div class="row">
                        <div class="col-3 text-white text-center">
                            <div class="p-3">
                                <img class="logo" ng-src="{{gdg.game.team1.team.logo.url}}" />
                                <a ui-sref="main.team.home({id: gdg.game.team1.team.id})"
                                   target="_blank">
                                    <h5 class="text-white m-0 d-inline-block">
                                        {{gdg.game.team1.team.isOpen? '(' + ('app.OpenTeam' | i18n) + ')' :gdg.game.team1.team.name}}
                                    </h5>
                                </a>
                            </div>
                            <div class="py-2">
                                <h1 class="text-center text-white score"
                                    ng-class="{'text-secondary': gdg.game.winningTeamId !== null && gdg.game.winningTeamId !== gdg.game.team1.team.id}">
                                    {{gdg.game.team1Score || 0}}
                                </h1>
                            </div>
                        </div>
                        <div class="col-6 p-3 text-center text-white">
                            <div class="mb-3">
                                <div ng-if="gdg.game.status !== gdg.gameStatusEnum.Finished">
                                    <!-- Game Clock -->
                                    <div class="game-clock mb-2"
                                         ng-show="gdg.game.isTimed">
                                        <span>TIME</span>
                                        <div class="w-100 d-flex justify-content-center align-items-center">
                                            <button class="btn"
                                                    ng-class="{'text-white': gdg.game.nextPossession === 1}"
                                                    ng-click="gdg.setNextPossession(1)">
                                                <i class="fa fa-caret-left fa-5x"></i>
                                            </button>
                                            <drbbly-timer on-ready="gdg.onTimerReady"
                                                          toggle-on-click="true"
                                                          font-size="'3em'"
                                                          class="game-clock"></drbbly-timer>
                                            <button class="btn"
                                                    ng-class="{'text-white': gdg.game.nextPossession === 2}"
                                                    ng-click="gdg.setNextPossession(2)">
                                                <i class="fa fa-caret-right fa-5x"></i>
                                            </button>
                                        </div>
                                        <div class="controls text-center"
                                             ng-cloak>
                                            <button class="btn btn-sm"
                                                    ng-if="!gdg.timer.isOver()"
                                                    ng-click="gdg.timer.toggle()">
                                                <i class="fa text-white"
                                                   ng-class="gdg.timer.isRunning()? 'fa-pause':'fa-play'"></i>
                                            </button>
                                            <button class="btn btn-sm"
                                                    ng-disabled="gdg.timer.isRunning()"
                                                    ng-click="gdg.timer.edit()">
                                                <i class="fa fa-pencil text-white"
                                                   uib-tooltip="{{gdg.timer.isRunning()? 'Cannot edit the clock while it is running':'Edit the clock'}}"></i>
                                            </button>
                                            <button class="btn btn-sm"
                                                    uib-tooltip="Advance to next period"
                                                    ng-disabled="gdg.isBusy"
                                                    ng-click="gdg.goToNextPeriod()"
                                                    ng-if="gdg.timer.isOver()">
                                                <i class="fa fa-angle-double-right text-white"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-around">
                                        <div class="text-center d-flex flex-column align-items-center px-3">
                                            <span class="">T.O.L.</span>
                                            <drbbly-lcddisplay text="gdg.game.team1.timeoutsLeft"
                                                               class="tol"
                                                               font-size="'2em'"></drbbly-lcddisplay>
                                        </div>
                                        <!-- Period + Shot Clock -->
                                        <div class="">
                                            <!-- Period -->
                                            <div class="period mb-2"
                                                 ng-if="gdg.game.isTimed">
                                                <span class="d-block text-center small">PERIOD</span>
                                                <drbbly-lcddisplay class="period"
                                                                   text="gdg._period"
                                                                   is-danger="dtc.timer.isOver()"
                                                                   on-click="dtc.clicked"></drbbly-lcddisplay>
                                            </div>
                                            <!-- Shot Clock -->
                                            <div class="shot-clock"
                                                 ng-show="gdg.game.isTimed">
                                                <drbbly-timer on-ready="gdg.onShotTimerReady"
                                                              class="game-clock"
                                                              is-shot-clock="true"
                                                              font-size="'3em'"
                                                              label="'SHOT CLOCK'"></drbbly-timer>
                                                <div class="controls text-center">
                                                    <button class="btn btn-sm text-white"
                                                            ng-click="gdg.setShotTime(gdg.game.defaultShotClockDuration * 1000, gdg.timer.isRunning())">
                                                        <i class="fa fa-undo"
                                                           uib-tooltip="Reset the clock"></i>&nbsp;{{gdg.game.defaultShotClockDuration}}
                                                    </button>
                                                    <button class="btn btn-sm text-white"
                                                            ng-click="gdg.setShotTime(gdg.game.offensiveRebondShotClock * 1000, gdg.timer.isRunning())">
                                                        <i class="fa fa-undo"
                                                           uib-tooltip="Reset the clock"></i>&nbsp;{{gdg.game.offensiveRebondShotClock}}
                                                    </button>
                                                    <button class="btn btn-sm"
                                                            ng-disabled="gdg.shotTimer.isRunning()"
                                                            ng-click="gdg.shotTimer.edit()">
                                                        <i class="fa fa-pencil text-white"
                                                           uib-tooltip="{{gdg.shotTimer.isRunning()? 'Cannot edit the clock while it is running':'Edit the clock'}}"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center d-flex flex-column align-items-center px-3">
                                            <span class="">T.O.L.</span>
                                            <drbbly-lcddisplay text="gdg.game.team2.timeoutsLeft"
                                                               class="tol"
                                                               font-size="'2em'"></drbbly-lcddisplay>
                                        </div>
                                    </div>

                                </div>
                                <div ng-if="gdg.game.status === gdg.gameStatusEnum.Finished">
                                    <div class="my-3 final">FINAL</div>
                                </div>
                            </div>
                            <div class="game-options">
                                <button type="button" class="btn btn-secondary"
                                        ng-if="gdg.game.status === gdg.gameStatusEnum.WaitingToStart"
                                        ng-click="gdg.jumpBall()">
                                    Jump Ball
                                </button>
                                <button type="button" class="btn btn-secondary"
                                        ng-if="gdg.game.status === gdg.gameStatusEnum.Started"
                                        ng-click="gdg.endGame()">
                                    End Game
                                </button>
                                <button type="button" class="btn btn-secondary"
                                        ng-if="gdg.game.status !== gdg.gameStatusEnum.WaitingToStart"
                                        ng-click="gdg.updateStatus(gdg.gameStatusEnum.WaitingToStart)">
                                    Reset Game
                                </button>
                            </div>
                        </div>
                        <div class="col-3 text-white text-center">
                            <div class="p-3">
                                <img class="logo" ng-src="{{gdg.game.team2.team.logo.url}}" />
                                <a ui-sref="main.team.home({id: gdg.game.team2.team.id})"
                                   target="_blank">
                                    <h5 class="text-white m-0 d-inline-block">
                                        {{gdg.game.team2.team.isOpen? '(' + ('app.OpenTeam' | i18n) + ')' :gdg.game.team2.team.name}}
                                    </h5>
                                </a>
                            </div>
                            <div class="py-2">
                                <h1 class="text-center text-white score"
                                    ng-class="{'text-secondary': gdg.game.winningTeamId !== null && gdg.game.winningTeamId !== gdg.game.team2.team.id}">
                                    {{gdg.game.team2Score || 0}}
                                </h1>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Player List and Controls -->
        <div class="row"
             ng-if="gdg.game.status !== gdg.gameStatusEnum.Finished">
            <!-- Team1 Players -->
            <div class="col-3 player-list">
                <table class="table table-sm table-light">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th class="w-100">Player</th>
                            <th>Pts</th>
                            <th class="d-none d-lg-table-cell">F</th>
                            <th class="d-none d-lg-table-cell">Reb</th>
                            <th class="d-none d-lg-table-cell">Ast</th>
                            <th class="d-none d-lg-table-cell">Blk</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="gamePlayer in gdg.game.team1.players"
                            class="player"
                            ng-click="gdg.togglePlayerSelection(gamePlayer)"
                            ng-class="{'selected': gamePlayer.isSelected}">
                            <td>{{gamePlayer.teamMembership.jerseyNo}}</td>
                            <td>{{gamePlayer.teamMembership.name}}</td>
                            <td>{{gamePlayer.points}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.fouls}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.rebounds}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.assists}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.blocks}}</td>
                        </tr>
                        <tr ng-if="gdg.game.team2.players.length === 0">
                            <td class="text-center" colspan="6">
                                No players found.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- Player Controls -->
            <div class="col-6 player-options">
                <!-- Selected Player Details -->
                <div class="selected-player bg-secondary text-white mb-3">
                    <div ng-show="gdg.selectedPlayer">
                        <table class="font-weight-bold">
                            <tr>
                                <td>
                                    <span class="jersey-no d-inline-block px-3 text-white">{{gdg.selectedPlayer.teamMembership.jerseyNo}}</span>
                                </td>
                                <td class="w-100">
                                    <span class="d-inline-block px-3">
                                        {{gdg.selectedPlayer.teamMembership.name}}
                                        <span ng-if="gdg.selectedPlayer.hasFouledOut || gdg.isEjected(gdg.selectedPlayer)"
                                              class="font-weight-light">
                                            ({{gdg.selectedPlayer.hasFouledOut? 'FOULED OUT':'EJECTED'}})
                                        </span>
                                    </span>
                                </td>
                                <td>
                                    <button class="btn btn-secondary ml-auto"
                                            ng-click="gdg.unselectPlayer(gdg.selectedPlayer)">
                                        <i class="fa fa-times"></i>
                                    </button>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="text-center p-2" ng-show="!gdg.selectedPlayer">
                        Select a player to update
                    </div>
                </div>
                <!-- Player Options -->
                <div class="options mb-3">
                    <div class="d-flex flex-column">
                        <button type="button"
                                class="btn btn-block btn-secondary"
                                ng-click="gdg.recordShot(1, false)"
                                ng-disabled="!gdg.canRecordShot()">
                            +1
                        </button>
                        <button type="button"
                                class="btn btn-block btn-secondary"
                                ng-click="gdg.recordShot(2, false)"
                                ng-disabled="!gdg.canRecordShot()">
                            +2
                        </button>
                        <button type="button"
                                class="btn btn-block btn-secondary"
                                ng-click="gdg.recordShot(3, false)"
                                ng-disabled="!gdg.canRecordShot()">
                            +3
                        </button>
                    </div>
                    <div class="flex-grow-1 flex-shrink-1 d-flex flex-column">
                        <button type="button"
                                class="btn btn-block btn-danger"
                                ng-click="gdg.recordShot(1, true)"
                                ng-disabled="!gdg.canRecordShot()">
                            miss 1
                        </button>
                        <button type="button"
                                class="btn btn-block btn-danger"
                                ng-click="gdg.recordShot(2, true)"
                                ng-disabled="!gdg.canRecordShot()">
                            miss 2
                        </button>
                        <button type="button"
                                class="btn btn-block btn-danger"
                                ng-click="gdg.recordShot(3, true)"
                                ng-disabled="!gdg.canRecordShot()">
                            miss 3
                        </button>
                    </div>
                    <div class="flex-grow-1 flex-shrink-1 d-flex flex-column">
                        <button type="button"
                                class="btn btn-block btn-secondary"
                                ng-click="gdg.recordFoul()"
                                ng-disabled="!gdg.canRecordFoul()">
                            Foul
                        </button>
                        <button type="button"
                                class="btn btn-block btn-secondary"
                                ng-click="gdg.timeout()">
                            Timeout
                        </button>
                    </div>
                </div>
            </div>
            <!-- Team2 Players -->
            <div class="col-3 player-list">
                <table class="table table-sm table-light">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th class="w-100">Player</th>
                            <th>Pts</th>
                            <th class="d-none d-lg-table-cell">F</th>
                            <th class="d-none d-lg-table-cell">Reb</th>
                            <th class="d-none d-lg-table-cell">Ast</th>
                            <th class="d-none d-lg-table-cell">Blk</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="gamePlayer in gdg.game.team2.players"
                            class="player"
                            ng-click="gdg.togglePlayerSelection(gamePlayer)"
                            ng-class="{'selected': gamePlayer.isSelected}">
                            <td>{{gamePlayer.teamMembership.jerseyNo}}</td>
                            <td>{{gamePlayer.teamMembership.name}}</td>
                            <td>{{gamePlayer.points}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.fouls}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.rebounds}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.assists}}</td>
                            <td class="d-none d-lg-table-cell">{{gamePlayer.blocks}}</td>
                        </tr>
                        <tr ng-if="gdg.game.team2.players.length === 0">
                            <td class="text-center" colspan="6">
                                No players found.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Play-By-Play -->
        <div class="row">
            <div class="col-12">
                <div class="bg-secondary w-100 text-center p-1 text-white">Play-by-Play</div>
                <drbbly-gameeventslist game="gdg.game"
                                       events="gdg.game.gameEvents"
                                       class="border"
                                       ng-if="gdg.game"></drbbly-gameeventslist>
            </div>
        </div>
    </div>
</div>
